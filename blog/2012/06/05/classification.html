<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru-ru">
<head>
	 <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	 <meta http-equiv="content-type" content="text/html; charset=utf-8" />
	 <title>О задачах классификации</title>
	 <meta name="author" content="Denis Bazhenov" />
	 <link href="http://feeds.feedburner.com/severe-reality" rel="alternate" title="Severe Reality" type="application/atom+xml" />
	 <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,600&subset=latin,cyrillic-ext,cyrillic' rel='stylesheet' type='text/css'>
	 
	 <link rel="openid2.provider" href="https://www.google.com/accounts/o8/ud?source=profiles" > 
	 <link rel="openid2.local_id" href="http://bazhenov.me/" >
	 
	 <!-- syntax highlighting CSS -->
	 <link rel="stylesheet" href="/css/syntax.css" type="text/css" />
	 <!-- Homepage CSS -->
	 <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
	 <link rel="stylesheet" href="http://yandex.st/highlightjs/6.1/styles/idea.min.css">

	<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
</head>
<body>

	<div class="site">
		
			<header>
				<div class="content">
					<a href="/">Суровая реальность</a>
				</div>
			</header>
		

		<div class="post content">
	<h1>О задачах классификации</h1>
	<div class="meta">
		<span class="date">05 June 2012</span>
		<span class="tags">
			
				<a href="/tags.html#information rerieval">information rerieval</a>
			
				<a href="/tags.html#classification">classification</a>
			
		</span>
		
	</div>
	
	
	<p>В этом и следующих постах, я хочу на пальцах описать процесс создания простого классификатора текстовых документов, а также рассказать о некоторых нетипичных с обывательской точки зрения подходах используемых при классификации документов.</p>

<p><a href="http://ru.wikipedia.org/wiki/Классификация_документов">Классификатор</a> – это алгоритм соотносящий некие входные данные с одним или несколькими классами. В отличие от алгоритмов <a href="http://ru.wikipedia.org/wiki/Кластерный_анализ">кластеризации</a> эти классы должны быть определены заранее. </p>

<p>Возможно, кому-то это определение покажется слишком общими или академическим, поэтому лучше наверное рассмотреть задачу классификации на примерах. А примеров хоть отбавляй.</p>

<!-- excerpt -->

<h2 id="section">Они повсюду</h2>

<p>Пожалуй самый яркий пример автоматической классификации – это фильтрация спама. Каждый день на мой ящик падает десятки если не сотни спам-писем, которые автоматически отфильтровываются из моего inbox&rsquo;а.</p>

<p class="image photo"><img src="/images/classification/spam.png" alt="Mail Spam" /></p>

<p>Современные коммерческие системы способны успешно фильтровать спам с точностью превышающей 99%<sup id="fnref:google-spam-filter-performance"><a href="#fn:google-spam-filter-performance" rel="footnote">1</a></sup>. Другим довольно типичным примером классификации служит автоматическое определение тематики того или иного текста. Некоторые новостные аггрераторы используют подобный подход для группировки новостей в направления: экономика, политика, общественная жизнь и т.д.</p>

<p>Зачастую классификация является фундаментом на котором строятся алгоритмы решения более сложных задач.
Например, классификация используется при создании рекомендательных систем и в частности при реализации <a href="http://ru.wikipedia.org/wiki/Коллаборативная_фильтрация">коллаборативной фильтрации</a>.</p>

<p class="image photo"><img src="/images/classification/recommendation.png" alt="Amazon recommendations" /></p>

<p>Safari Reader Mode является еще одним примером где используются алгоритмы классификации для достижения конечной цели. Суть этого режима работы браузера заключается в том что он позволяет автоматически убрать со страницы всю шелуху не имеющую отношения к сути контента страницы<sup id="fnref:boilerplate-paper"><a href="#fn:boilerplate-paper" rel="footnote">2</a></sup>.</p>

<p class="image photo"><img src="/images/classification/reader-mode.png" alt="Safari Reader Mode" /></p>

<p>Так же классификация используется в задачах face detection&rsquo;а и face recognition&rsquo;а.</p>

<p class="image photo"><img src="/images/classification/face-detection.png" alt="Face Detection in Aperture" /></p>

<p>Классификация используется как инструмент для решения множества других задач:</p>

<ul>
  <li>снятие омонимии при обработке натуральных языков;</li>
  <li>в поисковых системах – для ограничения области поиска в целях повышения точности (вертикальный поиск);</li>
  <li>автоматическое определение языка на котором написан текст;</li>
  <li>анализ тональности (определение эмоциональной окраски текста).</li>
</ul>

<p>Этот список можно продолжать еще долго. Например, в медицине алгоритмы классификации используются для реконструирования 3D модели головного мозга по серии МРТ снимков<sup id="fnref:mri-3d"><a href="#fn:mri-3d" rel="footnote">3</a></sup>, а также для диагностики пациентов страдающих синдромом Альцгеймера<sup id="fnref:alzheimer"><a href="#fn:alzheimer" rel="footnote">4</a></sup>.</p>

<h2 id="section-1">Традиционные подходы</h2>

<h3 id="rule-based-classification">Rule based classification</h3>

<p>Если говорить о задаче классификации текстов, то пожалуй ее традиционным решением является классификация основная на правилах (rule based classification). Вы имплементируете правила определения класса документа по его тексту в виде <code>if-then-else</code> выражений (код на Scala).</p>

<pre class="code"><code>def classify(text: String) =
	if (text.contains("виагра") || text.contains("бухгалтер")) "SPAM" else "NOT SPAM"
</code></pre>

<p>Этот подход может быть хорошим вариантом если вы работаете с небольшой коллекцией документов которую вы способны охватить и тщательно проанализировать. Просто потому что вы четко контролируете правила по которым классификатор принимает решения. Но есть у этого подхода и очевидные минусы:</p>

<ul>
  <li>для того чтобы выбрать значимые для классификации слова необходимо обладать экспертными знаниями в предметной области. Есть ли у вас например соображения по поводу ключевых слов которые хорошо отличают документы посвященные финансовой тематике от документов экономической? У меня очень смутные;</li>
  <li>отнюдь не всегда факт наличия или отсутствия какого-либо одного слова является решающим фактором для принятия решения.</li>
</ul>

<p>Поподробней остановлюсь на последнем пункте. Если вернуться к задаче определения спама и немного подумать о том какие слова являются хорошими классификационными признаками (classifying feature), то станет понятно что нет такого слова наличие которого гарантировало бы что сообщение является спамом. Возможно, в пределах компании производящей <a href="http://ru.wikipedia.org/wiki/Силденафил">силденафил</a> в промышленных масштабах слово &ldquo;виагра&rdquo; не является показательным признаком спам-сообщения, кто знает.</p>

<p>В общем, суть такова: <em>любое из известных спам-слов пусть редко но встречается в повседневной жизни.</em> Поэтому, принимать окончательно решение основываясь на факте наличия или отсутствия какого-либо одного слова идея контрпродуктивная. Мы можем усложнять правила добавляя вложенные <code>if</code>&lsquo;ы. Но довольно быстро вы поймете что возможности человека в формулировании таких правил очень ограничены, потому что <em>сложность правил растет экспоненциально с количеством выбранных для классификации слов</em>.</p>

<h3 id="weight-based-classification">Weight based classification</h3>

<p>Мы можем пойти другим путем. Мы можем для каждого слова выбрать некий вес, который будет означать насколько вероятно что сообщение с этим словом является спамом (0 – никогда не является спамом, 1 – всегда спам).</p>

<table class="center">
  <thead>
    <tr>
      <th>&nbsp;</th>
      <th>spam</th>
      <th>not spam</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>бухгалтер</td>
      <td>0.99</td>
      <td>0.01</td>
    </tr>
    <tr>
      <td>виагра</td>
      <td>0.99</td>
      <td>0.01</td>
    </tr>
    <tr>
      <td>выгодное</td>
      <td>0.70</td>
      <td>0.30</td>
    </tr>
    <tr>
      <td>github</td>
      <td>0.01</td>
      <td>0.99</td>
    </tr>
  </tbody>
</table>

<p>В этой таблице перечислены гипотетические веса для четырех слов. Сумма значений в строке должна быть равна единице. Тогда наша классификация может выглядеть следующим образом:</p>

<pre class="code"><code>def classify(text: String) = {
	val weights = Map("бухгалтер"-&gt;0.9, "виагра"-&gt;0.99, "выгодное"-&gt;0.7, "github"-&gt;0.01)
	val words = text.split(' ').filter(weights.contains(_))
	val P_spam = words.map(weights(_)).reduce(_ * _)
	val P_not_spam = words.map(1 - weights(_)).reduce(_ * _)
	if (P_spam &gt; P_not_spam) "SPAM" else "NOT SPAM"
}
</code></pre>

<p>Мы берем каждое слово и определяем суммарный вес документа отдельно для класса &ldquo;спам&rdquo; и класса &ldquo;не спам&rdquo;. Суммарный вес определяется как произведение весов всех известных слов документа. Слова для которых у нас нет веса мы пропускаем при классификации. Какой суммарный вес оказался больше тот класс и побеждает.</p>

<p>Это более разумный подход, так как он более гибок и принимает решение на основании всех известных слов в тексте. Так же его гораздо проще сопровождать чем полотна <code>if</code>&lsquo;ов. </p>

<h2 id="section-2">Метод машинного обучения</h2>

<p>А теперь очень важное замечание. <em>Если у нас будет некий способ автоматически подобрать оптимальные веса слов, то данный подход можно считать методом <a href="http://ru.wikipedia.org/wiki/Машинное_обучение">машинного обучения</a></em>. Сильно упрощенный, возможно даже гипертрофированный, но по своей сути это именно метод машинного обучения.</p>

<p>Если быть более точным, то описанный мною метод является зародышем <a href="http://ru.wikipedia.org/wiki/Наивный_байесовский_классификатор">наивного байесовского классификатора</a>. Но не позволяйте названию обмануть вас, NBC (Naïve Bayes Classifier) если не самый, то один из самых часто используемых классификаторов. Тому есть ряд причин:</p>

<ul>
  <li>он прост в имплементации и тестировании;</li>
  <li>процесс обучения довольно эффективен по сравнению с другими более сложными классификаторами;</li>
  <li>на небольших корпусах документов разница между NBC и другими гораздо более сложными алгоритмами классификации зачастую несущественна, а иногда NBC может оказаться и более точным<sup id="fnref:on-bayes-optimality"><a href="#fn:on-bayes-optimality" rel="footnote">5</a></sup>.</li>
</ul>

<p>В последующих заметках я более детально опишу вопросы связанные с созданием и тестированием подобного классификатора. Подписывайтесь на <a href="/rss.xml">RSS</a>.</p>

<h2 id="section-3">Ссылки по теме</h2>

<div class="footnotes">
  <ol>
    <li id="fn:google-spam-filter-performance">
      <p><a href="http://googlesystem.blogspot.com/2007/10/how-gmail-blocks-spam.html">How Gmail Blocks Spam</a><a href="#fnref:google-spam-filter-performance" rel="reference">&#8617;</a></p>
    </li>
    <li id="fn:boilerplate-paper">
      <p><a href="http://www.l3s.de/~kohlschuetter/publications/wsdm187-kohlschuetter.pdf">Boilerplate Detection using Shallow Text Features</a><a href="#fnref:boilerplate-paper" rel="reference">&#8617;</a></p>
    </li>
    <li id="fn:mri-3d">
      <p><a href="http://ieeexplore.ieee.org/xpl/login.jsp?tp=&amp;arnumber=1352574&amp;url=http%3A%2F%2Fieeexplore.ieee.org%2Fiel5%2F9356%2F29717%2F01352574.pdf%3Farnumber%3D1352574">Automatic classification of MRI images for three-dimensional volume reconstruction by using general regression neural networks</a><a href="#fnref:mri-3d" rel="reference">&#8617;</a></p>
    </li>
    <li id="fn:alzheimer">
      <p><a href="http://www.ncbi.nlm.nih.gov/pubmed/20542124">Automatic classification of patients with Alzheimer&rsquo;s disease from structural MRI: a comparison of ten methods using the ADNI database</a><a href="#fnref:alzheimer" rel="reference">&#8617;</a></p>
    </li>
    <li id="fn:on-bayes-optimality">
      <p><a href="http://www.cc.gatech.edu/fac/Charles.Isbell/classes/reading/papers/bayes-opt.pdf">On the Optimality of the Simple Bayesian Classifier under Zero-One Loss</a><a href="#fnref:on-bayes-optimality" rel="reference">&#8617;</a></p>
    </li>
  </ol>
</div>


	<div class="bar">
		<div class="g-plusone" data-size="medium"></div>
		<a href="https://twitter.com/share" class="twitter-share-button"
			data-url="http://bazhenov.me/blog/2012/06/05/classification.html"
			data-via="denis_bazhenov" data-lang="en">Tweet</a>

		<a href="https://twitter.com/denis_bazhenov" class="twitter-follow-button"
			data-show-count="false">Follow</a>
	</div>

	<div id="disqus_thread"></div>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

<!-- Google +1 button -->
<script type="text/javascript">
	(function() {
		var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
		po.src = 'https://apis.google.com/js/plusone.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
	})();
</script>

<!-- Twitter buttons -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

<!-- Disqus -->
<script type="text/javascript">
	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	var disqus_shortname='severe-reality';
	var disqus_developer=false;

	/* * * DON'T EDIT BELOW THIS LINE * * */
	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>

		<footer>
			<div class="content">
				<a href="http://feeds.feedburner.com/severe-reality">RSS Subscribe</a>
					|
				<a href="mailto:dotsid@gmail.com">Email</a>
			</div>
		</footer>
					
	</div>

	<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
	
	<script src="http://yandex.st/highlightjs/6.1/highlight.min.js"></script>
	<script>
	$(document).ready(function() {
		$('pre.code code').each(function(i, e) {hljs.highlightBlock(e, '  ')});
	});
	</script>
	<script type="text/javascript">
		MathJax.Hub.Config({
			tex2jax: {
				inlineMath: [['$','$'], ['\\(','\\)']],
				processEscapes: true
			}
		});
	</script>
	
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-31484732-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

</body>
</html>