<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru-ru">
<head>
	 <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	 <meta http-equiv="content-type" content="text/html; charset=utf-8" />
	 <title>Энди и Билл</title>
	 <meta name="author" content="Denis Bazhenov" />
	 <link href="http://feeds.feedburner.com/severe-reality" rel="alternate" title="Severe Reality" type="application/atom+xml" />

	 <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,600&subset=latin,cyrillic-ext,cyrillic' rel='stylesheet' type='text/css'>
	 <!-- syntax highlighting CSS -->
	 <link rel="stylesheet" href="/css/syntax.css" type="text/css" />

	 <!-- Homepage CSS -->
	 <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
	 <link rel="stylesheet" href="http://yandex.st/highlightjs/6.1/styles/idea.min.css">

	<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
	<script type="text/javascript"
	src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


	<script src="http://yandex.st/highlightjs/6.1/highlight.min.js"></script>
	<script>
	$(document).ready(function() {
		$('pre.code code').each(function(i, e) {hljs.highlightBlock(e, '  ')});
	});
	</script>
</head>
<body>

	<div class="site">

		<header>
			<div class="content">
				<a href="/">Суровая реальность</a>
			</div>
		</header>

		<div class="post content">
	<h1>Энди и Билл</h1>
	<div class="meta">
		<span class="date">19 July 2009</span>
		<span class="tags">
			
				<a href="/tags.html#concurrency">concurrency</a>
			
				<a href="/tags.html#threading">threading</a>
			
				<a href="/tags.html#performance">performance</a>
			
		</span>
		
	</div>
	
	
	<p>Вчера моя девушка купила себе Sims 3. Ну вы знаете&hellip; Маленькие человечки, которые постоянно требуют спать и есть. Эдакие тамагочи, которым хватает вычислительной мощности чтобы обсчитывать нравятся ли им их соседи, босс и прическа того волосатого парня, который косится на них в течении всей вечеринки. Полторы тысячи за лицензионную копию. И на обороте бокса вы можете прочитать:</p>

<blockquote>
  <p>Системные требования CPU: (XP) процессор P4 с частотой 2.0 ГГц или аналогичный: (Vista) процессор с частотой 2.4 ГГц или аналогичный. RAM: (XP) 1 Гб оперативной памяти: (Vista) 1.5 Гб оперативной памяти.</p>
</blockquote>

<p>Кто-нибудь задумывался над смыслом таких требований? Почему Vista требует на 20% более мощный процессор и на 50% больше оперативной памяти?</p>

<p>Существует шуточный закон &ldquo;Что Энди дал, то Билл забрал&rdquo; (&ldquo;Andy giveth, and Bill taketh away&rdquo;). Это означает, что прирост производительности даваемый каждым новым чипом компании Intel (Andy Grove) уравновешивается performance penalty нового продукта Microsoft (Bill Gates).</p>

<p>Конечно, это шутка, но в кажой шутке есть доля правды<sup id="fnref:quote"><a href="#fn:quote" rel="footnote">1</a></sup>. <em>Дайте программисту в два раза более мощный процессор и он найдет причину делать в два раза больше работы или не будет чувствовать особой вины в том, чтобы делать работу в два раза менее эффективно</em>. Зачем тратить время на оптимизацию ПО, если можно просто купить более мощный процессор? Это называется вертикальным масштабированием. И иногда, это чертовски хороший подход, потому что время программиста стоит дороже, чем время процессорное. Возьмие для примера Amazon&rsquo;овский Elastic Cloud. 1 час работы на восьми EC2 Unit (каждый unit это Opteron/Xeon c частотой примерно 2.5 ГГц) стоит&hellip; 80 центов<sup id="fnref:pricing"><a href="#fn:pricing" rel="footnote">2</a></sup>. Это примерно 18500 рублей в месяц. За такие деньги квалифицированного программиста вы себе не наймете. Но вертикальное масштабирование не панацея. И рано или поздно оно перестает работать. Учитывая, что тот экспоненциальный рост частоты процессоров (читай производительности) о котором говорят на каждом углу перестал быть экспоненциальным еще в 2003 году, оно пересает работать скорее рано чем поздно. Да да, у нас появилось много ядер. <a href="http://en.wikipedia.org/wiki/Intel_Core_i7">Новая линейка</a> чипов Intel для настольных систем содержит 4 физических/8 логических процессоров (кто бы мог подумать, HyperThreading по прежнему жив). Но значит ли это что приложения стали выполнятся в 4 раза быстрее? Нет.</p>

<p>Тому есть несколько причин. Во-первых, есть задачи, которые не параллелятся в принципе. Разбор XML хороший пример. Это чистого вида sequential задача. Во-вторых, есть так называемые точки сериализации, о которых я писал раньше<sup id="fnref:amdahls-law"><a href="#fn:amdahls-law" rel="footnote">3</a></sup>. Из-за них процессоры должны тратить некоторое время на обеспечение когерентности кеша, чтобы иметь корректное отображение оперативной памяти в кешах. Эти точки сериализации есть всегда (многие процессы, такие как выделения памяти, требуют координации на уровне операционной системы). Безусловно, то что я сказал, это некоторое упрощение реальной ситуации. Но смысл в том, что <em>2 * 2 ГГц не равно 4 ГГц</em>.</p>

<p>Наша проблема в том, что <em>долгое время мы ставили знак равенства между частотой и производительностью</em>. Что может быть проще, чем просто дождаться &ldquo;следующего шага&rdquo; Intel? Своего рода free lunch, о котором писал Herb Sutter еще в 2005 году<sup id="fnref:free-lunch"><a href="#fn:free-lunch" rel="footnote">4</a></sup>.</p>

<p>Справедливости ради хочу сказать, что я не виню Microsoft. Наоборот Windows 7, по моему мнению, делает успехи, и не только в плане производительности. Но <em>мы должны отказаться от той мысли, что инженеры Intel и AMD смогут легко увеличить производительность наших приложений путем наращивания частоты</em>. Теперь эти самые инженеры делают все для того, чтобы экспоненциальная гонка не останавливалась, даже если для этого придется <em>заставить программистов сменить парадигмы программирования</em>.</p>

<p>Что мы и наблюдаем. Функциональные языки набирают обороты. Microsoft Research занимается разработкой <a href="http://blog.functionalfun.net/2009/02/maestro-new-net-language-for-parallel.html">Maestro</a>. Java получает <a href="http://www.infoq.com/news/2008/03/fork_join">fork/join framework</a> и обзаводится реализацией <a href="http://www.deucestm.org/">software transactional memory</a>. И это только верхушка айсберга.</p>

<p>По словам того же Herb&rsquo;а Sutter&rsquo;а, <em>существующие реалии развития микропроцессоров должны совершить революцию во взглядах на то, как мы должны писать программы</em>. Последнюю такую революцию, по его мнению, совершило объектно-ориентированное программирование. Я более спокоен во взглядах на то, какую роль в нашей жизни играют параллельные вычисления. Но в чем-то Herb прав. Если хотите быть хорошим специалистом, самое время начать получать опыт работы с конкурентыми задачами.</p>

<p>Пока же Intel выжимает из своих процессоров все для того чтобы повысить sequential execution speed. И пока это так, я могу смело запустить Sims 3, продать старую раковину, купить новые обои в гостиную и пригласить кого-нибудь на сегодняшнюю вечеринку. Чертовски забавная игра, все таки.</p>

<div class="footnotes">
  <ol>
    <li id="fn:quote">
      <p><a href="http://geeklikemetoo.blogspot.com/2007/11/andy-giveth-and-bill-taketh-away.html">Andy Giveth and Bill Taketh Away</a><a href="#fnref:quote" rel="reference">&#8617;</a></p>
    </li>
    <li id="fn:pricing">
      <p><a href="http://aws.amazon.com/elasticmapreduce/#pricing">Amazon Elastic MapReduce: Pricing</a><a href="#fnref:pricing" rel="reference">&#8617;</a></p>
    </li>
    <li id="fn:amdahls-law">
      <p><a href="/blog/2009/01/13/moore's-law-a-la-finita.html">Конец эры закона Мура</a><a href="#fnref:amdahls-law" rel="reference">&#8617;</a></p>
    </li>
    <li id="fn:free-lunch">
      <p><a href="http://www.gotw.ca/publications/concurrency-ddj.htm">The Free Lunch Is Over: A Fundamental Turn Toward Concurrency in Software</a><a href="#fnref:free-lunch" rel="reference">&#8617;</a></p>
    </li>
  </ol>
</div>


	<div class="bar">
		<div class="g-plusone" data-size="medium"></div>
		<a href="https://twitter.com/share" class="twitter-share-button"
			data-url="http://bazhenov.me/blog/2009/07/19/Andy-and-Bill.html"
			data-via="denis_bazhenov" data-lang="en">Tweet</a>

		<a href="https://twitter.com/denis_bazhenov" class="twitter-follow-button"
			data-show-count="false">Follow</a>
	</div>

	<div class="related">
		<h2>Related Posts</h2>
		<ul class="posts">
			
				<li>
					<span>16 Apr 2012</span> &raquo;
					<a href="/blog/2012/04/16/one-in-a-million.html">Один на миллион</a>
				</li>
			
				<li>
					<span>26 Feb 2012</span> &raquo;
					<a href="/blog/2012/02/26/highload.html">О высокой нагрузке</a>
				</li>
			
				<li>
					<span>10 Jun 2011</span> &raquo;
					<a href="/blog/2011/06/10/deploy.html">Deploy и прочие неприятности</a>
				</li>
			
		</ul>
	</div>

	<div id="disqus_thread"></div>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

<!-- Google +1 button -->
<script type="text/javascript">
	(function() {
		var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
		po.src = 'https://apis.google.com/js/plusone.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
	})();
</script>

<!-- Twitter buttons -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

<!-- Disqus -->
<script type="text/javascript">
	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	var disqus_shortname='severe-reality';
	var disqus_developer=true;

	/* * * DON'T EDIT BELOW THIS LINE * * */
	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>

		<footer>
			<div class="content">
				<a href="http://feeds.feedburner.com/severe-reality">RSS Subscribe</a>
					|
				<a href="mailto:dotsid@gmail.com">Email</a>
			</div>
		</footer>
					
	</div>

	<script type="text/javascript">
		MathJax.Hub.Config({
			tex2jax: {
				inlineMath: [['$','$'], ['\\(','\\)']],
				processEscapes: true
			}
		});
	</script>

</body>
</html>