<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru-ru">
<head>
	 <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	 <meta http-equiv="content-type" content="text/html; charset=utf-8" />
	 <title>HighLoad++ 2010 - впечатления</title>
	 <meta name="author" content="Denis Bazhenov" />
	 <link href="http://feeds.feedburner.com/severe-reality" rel="alternate" title="Severe Reality" type="application/atom+xml" />

	 <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,600&subset=latin,cyrillic-ext,cyrillic' rel='stylesheet' type='text/css'>
	 <!-- syntax highlighting CSS -->
	 <link rel="stylesheet" href="/css/syntax.css" type="text/css" />

	 <!-- Homepage CSS -->
	 <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
	 <link rel="stylesheet" href="http://yandex.st/highlightjs/6.1/styles/idea.min.css">

	<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
</head>
<body>

	<div class="site">
		
			<header>
				<div class="content">
					<a href="/">Суровая реальность</a>
				</div>
			</header>
		

		<div class="post content">
	<h1>HighLoad++ 2010 - впечатления</h1>
	<div class="meta">
		<span class="date">31 October 2010</span>
		<span class="tags">
			
				<a href="/tags.html#highload">highload</a>
			
				<a href="/tags.html#conference">conference</a>
			
		</span>
		
	</div>
	
	
	<p>В этом году я побывал на <a href="http://www.highload.ru/">HighLoad++</a>. Event довольно интересный, поэтому я попытаюсь вкратце описать свои впечатления, а так же основные тенденции наблюдаемые на конференции.</p>

<p>Во-первых, стоит отметить, что <a href="http://ontico.ru/vita/p/2010/hl-abstracts-2010.pdf">тезисы докладов</a> и <a href="http://ontico.ru/vita/p/2010/hl-presentations-2010.rar">презентации</a> доступны на официальном сайте конференции.</p>

<p>Я живу во Владивостоке, поэтому мне пришлось пролететь очень большое расстояние чтобы попасть на конференцию. Этим частично обусловлено мое отношение к конференции как к таковой.</p>

<p>Начнем с приятного. На конференции действительно были специалисты с которыми было интересно общаться. Чувствовалось что люди знают о чем говорят и эту информацию они получили не из мануалов в интернете, а из своей ежедневной практики.</p>

<p>Организация была вполне приемлемая: был WiFi (который впрочем почему-то не ловил мой телефон) и достаточно еды (на которую у меня впрочем не было времени). Расписание было составлено таким образом, что самые интересные доклады параллельно не шли, а это радует.</p>

<h2 id="section">Основные понравившиеся доклады</h2>

<h3 id="performance-tweaks-and-tools-for-linux--joe-damato">Performance tweaks and tools for Linux / Joe Damato</h3>

<p>В этом докладе рассказывается об основных инструментах профилирования под Linux — <code>lsof</code>, <code>strace</code>, <code>ltrace</code>, <code>oprofile</code>. Но об этом знают если не все, то почти все. Интересен этот доклад другим. Joe будучи Ruby хакером создал набор довольно интересных инструментов для профилирования Ruby приложений при помощи этих низкоуровневых инструментов.</p>

<h3 id="robert-johnson">Секреты Фейсбука: как выдержать 50 миллионов запросов в секунду / Robert Johnson</h3>

<p>Robert Johnson — ведущий инженер по разработке ПО в компании Facebook (а по совместительству, как и я, <a href="http://www.facebook.com/profile/pic.php?oid=AQDx6Dr4kb3wd6HUdPHzb4sbFXzOmKVdmlvP77DIo3qHwL1WPrOX-uu2jInbXcoGWR4&amp;size=normal">владелец Jackson&rsquo;а</a>). Роберт много говорил не только о технической стороне масштабирования, но и об организационных мерах и том, каких направлений должен придерживаться коллектив участвующий в разработке высоконагруженного приложения. Основные посылы следующие:</p>

<ol>
  <li>большому проекту рано или поздно прийдется столкнутся с горизонтальным масштабированием;</li>
  <li>все изменения должны быть инкрементальными (нет изменений, которые не могут быть отменены);</li>
  <li>если вы не можете что-то измерить, вы не можете этим управлять;</li>
  <li>работа в небольших независимых коллективах (от 3 до 7 человек) над разными проектами (фотографии, личные сообщения и т.д.);</li>
  <li>люди ответственные за что-либо должны иметь контроль над этим.</li>
</ol>

<p>В личном общении с Робертом я смог узнать следующие вещи:</p>

<ul>
  <li>социальные графы очень тяжело partition&rsquo;ить. Я спросил не пытались ли они заимствовать опыт MMORPG проектов? По идее у них схожие задачи, но гораздо более жесткие требования к latency. Роберт сказал, что это интересная идея, но ничего подобного они не пробовали делать. Так же он не особо верит в том что алгоритмы кластеризации графов смогут помочь им решить эту проблему в общем виде и достичь при этом вменяемой производительности;</li>
  <li>их custom&rsquo;ный протокол репликации в mysql, обошелся им в десяток строк кода, что и обусловило использование такого, на мой взгляд, странного решения;</li>
  <li>в довольно большом проекте в угоду производительности коллектива в целом приходится принимать такие решения, как писать HipHop. Насколько я понял, Роберт не особо верит в его широкий adoption за пределами Facebook. Это довольно специфические решение проблемы в их специфическом окружении.</li>
</ul>

<h3 id="mailru---">Быстрое развертывание шаблонов и статики в Mail.ru / Николай Кондратов</h3>

<p>Несмотря на немного &ldquo;попсовое&rdquo; название, доклад был довольно интересный. Ребята рассказывали о том, как они организовали работу верстальщиков и какие инструменты они им дали для развертывания приложения на сервере. Основная особенность больших систем не только в высокой нагрузке, но и в очень сложных процедурах развертывания системы. Последний факт почему-то редко получает много внимания, а зря.</p>

<p>В mail.ru особенности процесса следующие:</p>

<ul>
  <li>шаблоны пишутся на псевдоязыке и позже могут быть транслированы в C/Perl;
шаблоны и статика доставляются на production отдельно от кода приложения, тем самым код и шаблоны могут меняться независимо. Схема выглядит довольно хрупко. На мой вопрос: &ldquo;как вы избегаете несовместимых изменений между кодом и шаблонами?&rdquo;, они ответили: &ldquo;мы внимательно следим за этим&rdquo;;</li>
  <li>у каждого разработчика есть свой сетевой диск (который монтируется при помощи FUSE). Этот диск связан с отдельным для разработчика доменом, на котором крутится приложение;</li>
  <li>артефакт с шаблонами и статикой доставляется на production машину, с которой посредством p2p сети (torrent) распространяется по frontend&rsquo;ам. Исходная машина работает в режиме суперсидирования (то есть каждый блок отдается только единожды). Ребята объяснили такое решение тем, что в противном случае у них заканчивается network bandwidth на исходной машине (размер артефакта порядка 100Mb).</li>
</ul>

<h3 id="progressive-downloads-and-rendering--stoyan-stefanov-yahoo">Progressive downloads and Rendering / Stoyan Stefanov (Yahoo)</h3>

<p>Yahoo, как известно &ldquo;помешана&rdquo; на оптимизации на клиентской стороне. Этот доклад всецело посвящен такого рода оптимизациям. Много говорилось про user perception и то как люди оценивают производительность. О том что стабильность производительности (среднеквадратичное отклонение) важнее, чем абсолютные значения latency. Про аттрибуты <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/scripting-1.html#attr-script-async">async и deffered</a>, которые предоставляет HTML5. Про то что такое chunked response и как его использует Google и Amazon. Как CSS может значительно снизить производительность вашего web-приложения. Доклад довольно довольно последовательный, так что очень советую посмотреть <a href="http://www.slideshare.net/stoyan/progressive-downloads-and-rendering">слайды</a> а также <a href="http://vimeo.com/15981041">видео</a>.</p>

<p>Я из этого доклада я вынес следующее: performance is a feature (этот тезис всплывал на конференции не раз). Если вы хотите чтобы ваше приложение быстро рендерилось на стороне клиента (что очень важно еще и в связи с ростом процента мобильных клиентов), то к этому вопросу над подходить как к фиче. Несмотря на расхожее мнение, добавить такого рода оптимизации в уже существующее приложение написанное без оглядки на вопросы client side performance, может быть довольно непросто.</p>

<h3 id="thinking-clearly-about-performance--carry-millsap">Thinking Clearly About Performance / Carry Millsap</h3>

<p>&ldquo;Пушка&rdquo; первого дня. Несмотря на относительно низкую практическую ценность доклада, я считаю что излагаемая в нем информация очень важна, — она вправляет мозги. В докладе излагается последовательный, целостный, математический подход к оценке производительности и пропускной способности. Поэтому вдвойне жалко что зал был почти пустой: человек 15-20.</p>

<p>Основные постулаты:</p>

<ul>
  <li>пропускная способность и время отклика связаны опосредованно. Узнать одну метрику по другой, вы можете только в ряде частных случаев. В общем случае, вы должны измерять обе метрики независимо.</li>
  <li>арифметическое среднее не самый удачный способ оценки производительности. <a href="http://en.wikipedia.org/wiki/Percentile">Percentile</a> значения лучше.</li>
  <li>важна не только абсолютная мера производительности, но и стабильность этой меры (дисперсия времени отклика);</li>
  <li>для того чтобы достичь стабильной производительности, необходимо контролировать утилизацию исполнителей (для чего в <a href="http://ru.wikipedia.org/wiki/Теория_массового_обслуживания">теории систем массового обслуживания</a> есть соответствующий мат. аппарат);</li>
  <li>существуют некоторые <a href="http://en.wikipedia.org/wiki/Gustafson's_law">фундаментальные</a> <a href="http://en.wikipedia.org/wiki/Amdahl's_law">законы</a>, которые ограничивают максимальную пропускную способность. Вы должны знать их.</li>
</ul>

<p>Я очень советую прочитать <a href="http://method-r.com/downloads/doc_details/44-thinking-clearly-about-performance">одноименную публикацию</a>, чтобы получить более полное представление об этом материале.</p>

<h2 id="section-1">Закулисы</h2>

<p>И все же большая часть информации была получена не на докладах, а за кулисами. Именно там была возможность пообщаться с опытными людьми: как докладчиками, так и просто участниками конференции. Из этого общения я вынес для себя несколько моментов:</p>

<ul>
  <li><a href="http://sphinxsearch.com/">Sphinx</a> очень популярен. Этим фактом, впрочем, никого не удивишь, но тем не менее полезно было получить тому подтверждение от людей реально его использующих;</li>
  <li><a href="http://code.google.com/p/redis/">Redis</a> тоже довольно популярное решение, что для меня стало новостью. Я встретил по меньшей мере пятерых человек из разных компаний, которые используют это хранилище;</li>
  <li>стандартная библиотека Scala изобилует довольно &ldquo;детскими&rdquo; багами как функциональными, так performance-related. Если вы хотите использовать Scala в крупном проекте, есть смысл подумать об использовании стандартной библиотеки Java, как бы грустно это ни звучало;</li>
  <li>системы асинхронного обмена сообщениями тоже получили довольно широкий adoption. Очень много кто использует те или иные реализации очередей (в основном memcacheQ и Redis);</li>
  <li>и несмотря на это, практически никто не знаком с <a href="http://www.eaipatterns.com/">EIP</a>, основополагающим трудом в этой области;
вопреки расхожему мнению, вопрос найма специалистов стоит остро в любой точке нашей страны (а возможно и планеты). Владивосток, будучи относительно небольшим городом, в этом отношении не особо хуже Москвы.</li>
</ul>

<h2 id="section-2">Ложка дёгтя</h2>

<p>Впрочем, не все так безоблачно. До сих пор, я намеренно игнорировал негативные моменты связанные с конференцией:</p>

<ul>
  <li>некоторые доклады были попросту скучные, а некоторые я считаю вредные. Абсолютизм пропагандируемый в докладе &ldquo;Практическое создание крупного масштабируемого web 2.0 проекта с нуля&rdquo; это на мой взгляд один из худших феноменов, который может настигнуть специалиста. Масштабируемость в этом докладе провозглашается чуть ли не самодостаточным свойством системы ради которого и &ldquo;крутится Земля&rdquo;. Попытки аудитории обратить внимание докладчика на то что иногда существуют определенные требования к гарантии в отношении consistency (которые влияют на принимаемые решения и выбор инструментов) не увенчались успехом;</li>
  <li>некоторые участники в личном общении беззастенчиво утоляли собственные комплексы. Один участник в течении 10 минут пытался мне объяснить что настраивать GC в Java очень просто. Объяснения сводились примерно к следующему. В Java есть один стоящий GC — Parallel GC, все остальное — ошибка природы. Серьезно к такому мнению относится не получается (на самом деле, это еще один частный случай абсолютизма описанного в предыдущем пункте);</li>
  <li>в рамках конференции был круглый стол об использовании SMP систем. Intel прислала на это событие не технического специалиста, а, если я не ошибаюсь, менеджера по связям с общественностью. Стоит ли говорить, что это не тот кого мы ждали;</li>
  <li>вообще, в конце докладов оставалось очень мало времени на вопросы. Иногда доходило до смешного, в конце доклада организаторы говорили: &ldquo;у нас есть время на два вопроса&rdquo;. Два вопроса?! Вы издеваетесь?! По факту, обсуждение докладов осуществлялось за кулисами в компании 5-10 особо заинтересованных участников и самого автора.</li>
</ul>

<h2 id="section-3">В сухом остатке</h2>

<p>Участие в конференции составило 15 000 рублей. Для иногородних еще стоимость билетов и проживания в городе. Поэтому я бы дал следующий совет тем, кто собирается поехать на HighLoad++ в будущем. И пожалуй я это выделю в отдельный абзац.</p>

<p><em>Основной источник информации на такого рода event&rsquo;ах — это личное общение.</em></p>

<p>Не стоит ехать на конференцию если вы собираетесь ограничиться прослушиванием докладов или вы социофоб. Необходимо знакомится с участниками, общаться, задавать вопросы, выражать свое мнение и провоцировать людей на дискуссии. Только тогда участие в конференции будет экономически целесообразным.</p>

<p>Вот наверное и все. Если у вас есть еще какие-либо вопросы, с удовольствием отвечу на них.</p>



	<div class="bar">
		<div class="g-plusone" data-size="medium"></div>
		<a href="https://twitter.com/share" class="twitter-share-button"
			data-url="http://bazhenov.me/blog/2010/10/31/highload-2010.html"
			data-via="denis_bazhenov" data-lang="en">Tweet</a>

		<a href="https://twitter.com/denis_bazhenov" class="twitter-follow-button"
			data-show-count="false">Follow</a>
	</div>

	<div id="disqus_thread"></div>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

<!-- Google +1 button -->
<script type="text/javascript">
	(function() {
		var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
		po.src = 'https://apis.google.com/js/plusone.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
	})();
</script>

<!-- Twitter buttons -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

<!-- Disqus -->
<script type="text/javascript">
	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	var disqus_shortname='severe-reality';
	var disqus_developer=true;

	/* * * DON'T EDIT BELOW THIS LINE * * */
	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>

		<footer>
			<div class="content">
				<a href="http://feeds.feedburner.com/severe-reality">RSS Subscribe</a>
					|
				<a href="mailto:dotsid@gmail.com">Email</a>
			</div>
		</footer>
					
	</div>

	<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
	
	<script src="http://yandex.st/highlightjs/6.1/highlight.min.js"></script>
	<script>
	$(document).ready(function() {
		$('pre.code code').each(function(i, e) {hljs.highlightBlock(e, '  ')});
	});
	</script>
	<script type="text/javascript">
		MathJax.Hub.Config({
			tex2jax: {
				inlineMath: [['$','$'], ['\\(','\\)']],
				processEscapes: true
			}
		});
	</script>
	<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-31484732-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>